{"ast":null,"code":"// src/pages/BookDetail.jsx\nimport React,{useEffect,useState}from\"react\";import{useParams,Link}from\"react-router-dom\";import axios from\"axios\";import\"./BookDetail.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function BookDetail(){const{id}=useParams();// book id from url\nconst[book,setBook]=useState(null);const[loading,setLoading]=useState(true);const BACKENDURL=process.env.REACT_APP_BACKEND_URL;// review form state\nconst[user,setUser]=useState(\"\");const[reviewText,setReviewText]=useState(\"\");const[rating,setRating]=useState(0);const[submitting,setSubmitting]=useState(false);useEffect(()=>{fetchBook();// eslint-disable-next-line\n},[id]);const fetchBook=async()=>{setLoading(true);try{const res=await axios.get(\"\".concat(BACKENDURL,\"/api/books/\").concat(id));setBook(res.data);}catch(err){console.error(\"Error fetching book:\",err);setBook(null);}finally{setLoading(false);}};const handleAddReview=async e=>{e.preventDefault();if(!reviewText||rating===0){return alert(\"Please enter a review and select a rating.\");}setSubmitting(true);try{await axios.post(\"\".concat(BACKENDURL,\"/\").concat(id,\"/reviews\"),{user:user||\"Anonymous\",comment:reviewText,rating});// Clear inputs\nsetUser(\"\");setReviewText(\"\");setRating(0);// Refresh book to get updated reviews and rating\nawait fetchBook();}catch(err){console.error(\"Error adding review:\",err);alert(\"Failed to add review.\");}finally{setSubmitting(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading...\"});}if(!book){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:\"Book not found.\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"book-detail-container\",children:[/*#__PURE__*/_jsx(Link,{to:\"/explore\",className:\"back-btn\",children:\"\\u2190 Back to Explore\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"book-detail-card\",children:[/*#__PURE__*/_jsx(\"img\",{src:book.cover||book.image||\"https://via.placeholder.com/250x350\",alt:book.title,className:\"detail-cover\",onError:e=>e.target.src=\"https://via.placeholder.com/250x350\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-info\",children:[/*#__PURE__*/_jsx(\"h1\",{children:book.title}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"by \",book.author]}),/*#__PURE__*/_jsx(\"p\",{className:\"short-desc\",children:book.description}),/*#__PURE__*/_jsxs(\"p\",{className:\"rating\",children:[\"\\u2B50 \",book.rating||\"0.0\"]}),/*#__PURE__*/_jsx(\"h4\",{children:\"Reviews:\"}),book.reviews&&book.reviews.length>0?/*#__PURE__*/_jsx(\"ul\",{className:\"reviews-list\",children:book.reviews.map((r,i)=>/*#__PURE__*/_jsxs(\"li\",{className:\"review-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"review-header\",children:[/*#__PURE__*/_jsx(\"strong\",{children:r.user||\"Anonymous\"}),r.rating!==undefined&&/*#__PURE__*/_jsxs(\"span\",{className:\"review-rating\",children:[\" \\u2014 \\u2B50 \",r.rating]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"review-comment\",children:r.comment}),/*#__PURE__*/_jsx(\"small\",{className:\"review-date\",children:new Date(r.date).toLocaleString()})]},r._id||i))}):/*#__PURE__*/_jsx(\"p\",{children:\"No reviews yet.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"add-review-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Add a Review\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAddReview,className:\"review-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Your name (optional)\",value:user,onChange:e=>setUser(e.target.value)}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Write your review...\",value:reviewText,onChange:e=>setReviewText(e.target.value),rows:\"3\"}),/*#__PURE__*/_jsxs(\"select\",{value:rating,onChange:e=>setRating(Number(e.target.value)),children:[/*#__PURE__*/_jsx(\"option\",{value:\"0\",children:\"Select rating\"}),[1,2,3,4,5].map(num=>/*#__PURE__*/_jsxs(\"option\",{value:num,children:[num,\" \\u2B50\"]},num))]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-review-btn\",disabled:submitting,children:submitting?\"Submitting...\":\"Submit Review\"})]})]})]})]})]});}export default BookDetail;","map":{"version":3,"names":["React","useEffect","useState","useParams","Link","axios","jsx","_jsx","jsxs","_jsxs","BookDetail","id","book","setBook","loading","setLoading","BACKENDURL","process","env","REACT_APP_BACKEND_URL","user","setUser","reviewText","setReviewText","rating","setRating","submitting","setSubmitting","fetchBook","res","get","concat","data","err","console","error","handleAddReview","e","preventDefault","alert","post","comment","className","children","to","src","cover","image","alt","title","onError","target","author","description","reviews","length","map","r","i","undefined","Date","date","toLocaleString","_id","onSubmit","type","placeholder","value","onChange","rows","Number","num","disabled"],"sources":["C:/Users/kavik/Downloads/nileshProject/book-review/frontend/src/pages/BookDetail.jsx"],"sourcesContent":["// src/pages/BookDetail.jsx\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useParams, Link } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport \"./BookDetail.css\";\r\n\r\nfunction BookDetail() {\r\n  const { id } = useParams(); // book id from url\r\n  const [book, setBook] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const BACKENDURL = process.env.REACT_APP_BACKEND_URL;\r\n\r\n\r\n  // review form state\r\n  const [user, setUser] = useState(\"\");\r\n  const [reviewText, setReviewText] = useState(\"\");\r\n  const [rating, setRating] = useState(0);\r\n  const [submitting, setSubmitting] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetchBook();\r\n    // eslint-disable-next-line\r\n  }, [id]);\r\n\r\n  const fetchBook = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await axios.get(`${BACKENDURL}/api/books/${id}`);\r\n      setBook(res.data);\r\n    } catch (err) {\r\n      console.error(\"Error fetching book:\", err);\r\n      setBook(null);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleAddReview = async (e) => {\r\n    e.preventDefault();\r\n    if (!reviewText || rating === 0) {\r\n      return alert(\"Please enter a review and select a rating.\");\r\n    }\r\n\r\n    setSubmitting(true);\r\n    try {\r\n      await axios.post(`${BACKENDURL}/${id}/reviews`, {\r\n        user: user || \"Anonymous\",\r\n        comment: reviewText,\r\n        rating,\r\n      });\r\n\r\n      // Clear inputs\r\n      setUser(\"\");\r\n      setReviewText(\"\");\r\n      setRating(0);\r\n\r\n      // Refresh book to get updated reviews and rating\r\n      await fetchBook();\r\n    } catch (err) {\r\n      console.error(\"Error adding review:\", err);\r\n      alert(\"Failed to add review.\");\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <div className=\"loading\">Loading...</div>;\r\n  }\r\n\r\n  if (!book) {\r\n    return <div className=\"error\">Book not found.</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"book-detail-container\">\r\n      <Link to=\"/explore\" className=\"back-btn\">← Back to Explore</Link>\r\n\r\n      <div className=\"book-detail-card\">\r\n        <img\r\n          src={book.cover || book.image || \"https://via.placeholder.com/250x350\"}\r\n          alt={book.title}\r\n          className=\"detail-cover\"\r\n          onError={(e) => (e.target.src = \"https://via.placeholder.com/250x350\")}\r\n        />\r\n\r\n        <div className=\"detail-info\">\r\n          <h1>{book.title}</h1>\r\n          <h3>by {book.author}</h3>\r\n          <p className=\"short-desc\">{book.description}</p>\r\n          <p className=\"rating\">⭐ {book.rating || \"0.0\"}</p>\r\n\r\n          <h4>Reviews:</h4>\r\n          {book.reviews && book.reviews.length > 0 ? (\r\n            <ul className=\"reviews-list\">\r\n              {book.reviews.map((r, i) => (\r\n                <li key={r._id || i} className=\"review-item\">\r\n                  <div className=\"review-header\">\r\n                    <strong>{r.user || \"Anonymous\"}</strong>\r\n                    {r.rating !== undefined && (\r\n                      <span className=\"review-rating\"> — ⭐ {r.rating}</span>\r\n                    )}\r\n                  </div>\r\n                  <p className=\"review-comment\">{r.comment}</p>\r\n                  <small className=\"review-date\">{new Date(r.date).toLocaleString()}</small>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          ) : (\r\n            <p>No reviews yet.</p>\r\n          )}\r\n\r\n          {/* Add Review Form */}\r\n          <div className=\"add-review-section\">\r\n            <h4>Add a Review</h4>\r\n            <form onSubmit={handleAddReview} className=\"review-form\">\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Your name (optional)\"\r\n                value={user}\r\n                onChange={(e) => setUser(e.target.value)}\r\n              />\r\n\r\n              <textarea\r\n                placeholder=\"Write your review...\"\r\n                value={reviewText}\r\n                onChange={(e) => setReviewText(e.target.value)}\r\n                rows=\"3\"\r\n              />\r\n\r\n              <select value={rating} onChange={(e) => setRating(Number(e.target.value))}>\r\n                <option value=\"0\">Select rating</option>\r\n                {[1, 2, 3, 4, 5].map((num) => (\r\n                  <option key={num} value={num}>\r\n                    {num} ⭐\r\n                  </option>\r\n                ))}\r\n              </select>\r\n\r\n              <button type=\"submit\" className=\"submit-review-btn\" disabled={submitting}>\r\n                {submitting ? \"Submitting...\" : \"Submit Review\"}\r\n              </button>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default BookDetail;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}